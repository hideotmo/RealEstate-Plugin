(function(a){a.jPanelMenu=function(b){if(typeof(b)=="undefined"||b==null){b={}}var c={options:a.extend({menu:"#menu",panel:"body",trigger:".menu-trigger",excludedPanelContent:"style, script",clone:true,keepEventHandlers:false,direction:"left",openPosition:"250px",animated:true,closeOnContentClick:true,keyboardShortcuts:[{code:27,open:false,close:true},{code:37,open:false,close:true},{code:39,open:true,close:true},{code:77,open:true,close:true}],duration:150,openDuration:b.duration||150,closeDuration:b.duration||150,easing:"ease-in-out",openEasing:b.easing||"ease-in-out",closeEasing:b.easing||"ease-in-out",before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},b),settings:{transitionsSupported:"WebkitTransition" in document.body.style||"MozTransition" in document.body.style||"msTransition" in document.body.style||"OTransition" in document.body.style||"Transition" in document.body.style,transformsSupported:"WebkitTransform" in document.body.style||"MozTransform" in document.body.style||"msTransform" in document.body.style||"OTransform" in document.body.style||"Transform" in document.body.style,cssPrefix:"",panelPosition:"static",positionUnits:"px"},menu:"#jPanelMenu-menu",panel:".jPanelMenu-panel",timeouts:{},clearTimeouts:function(){clearTimeout(c.timeouts.open);clearTimeout(c.timeouts.afterOpen);clearTimeout(c.timeouts.afterClose)},setPositionUnits:function(){var d=false,g=["%","px","em"];for(var f=0;f<g.length;f++){var e=g[f];if(c.options.openPosition.toString().substr(-e.length)==e){d=true;c.settings.positionUnits=e}}if(!d){c.options.openPosition=parseInt(c.options.openPosition)+c.settings.positionUnits}},computePositionStyle:function(g,f){var d=(g)?c.options.openPosition:"0"+c.settings.positionUnits;var h={};if(c.settings.transformsSupported){var i=(g&&c.options.direction=="right")?"-":"";var j="translate3d("+i+d+",0,0)";var e="transform";if(f){h="";if(c.settings.cssPrefix!=""){h=c.settings.cssPrefix+e+":"+j+";"}h+=e+":"+j+";"}else{if(c.settings.cssPrefix!=""){h[c.settings.cssPrefix+e]=j}h[e]=j}}else{if(f){h="";h=c.options.direction+": "+d+";"}else{h[c.options.direction]=d}}return h},setCSSPrefix:function(){c.settings.cssPrefix=c.getCSSPrefix()},setjPanelMenuStyles:function(){var e="background:#fff",f=a("html").css("background-color"),d=a("body").css("background-color");var g=function(h){var i=[];a.each(["background-color","background-image","background-position","background-repeat","background-attachment","background-size","background-clip"],function(j,k){if(h.css(k)!==""){i.push(k+":"+h.css(k))}});return i.join(";")};if(d!=="transparent"&&d!=="rgba(0, 0, 0, 0)"){e=g(a("body"))}else{if(f!=="transparent"&&f!=="rgba(0, 0, 0, 0)"){e=g(a("html"))}}if(a("#jPanelMenu-style-master").length==0){a("body").append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+c.options.direction+":0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;"+c.options.direction+":0;top:0;z-index:2;width:100%;min-height:100%;"+e+";}</style>")}},setMenuState:function(e){var d=(e)?"open":"closed";a(c.options.panel).attr("data-menu-position",d)},getMenuState:function(){return a(c.options.panel).attr("data-menu-position")},menuIsOpen:function(){if(c.getMenuState()=="open"){return true}else{return false}},setMenuStyle:function(d){a(c.menu).css(d)},setPanelStyle:function(d){a(c.panel).css(d)},showMenu:function(){c.setMenuStyle({display:"block"});c.setMenuStyle({"z-index":"1"})},hideMenu:function(){c.setMenuStyle({"z-index":"-1"});c.setMenuStyle({display:"none"})},enableTransitions:function(e,g){var f=e/1000;var d=c.getCSSEasingFunction(g);c.disableTransitions();a("body").append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{'+c.settings.cssPrefix+"transition: all "+f+"s "+d+"; transition: all "+f+"s "+d+";}</style>")},disableTransitions:function(){a("#jPanelMenu-style-transitions").remove()},getCSSEasingFunction:function(d){switch(d){case"linear":return d;break;case"ease":return d;break;case"ease-in":return d;break;case"ease-out":return d;break;case"ease-in-out":return d;break;default:return"ease-in-out";break}},getJSEasingFunction:function(d){switch(d){case"linear":return d;break;default:return"swing";break}},getVendorPrefix:function(){if("result" in arguments.callee){return arguments.callee.result}var d=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/;var f=document.getElementsByTagName("script")[0];for(var e in f.style){if(d.test(e)){return arguments.callee.result=e.match(d)[0]}}if("WebkitOpacity" in f.style){return arguments.callee.result="Webkit"}if("KhtmlOpacity" in f.style){return arguments.callee.result="Khtml"}return arguments.callee.result=""},getCSSPrefix:function(){var d=c.getVendorPrefix();if(d!=""){return"-"+d.toLowerCase()+"-"}return""},openMenu:function(g){if(typeof(g)=="undefined"||g==null){g=c.options.animated}c.clearTimeouts();c.options.before();c.options.beforeOpen();c.setMenuState(true);c.showMenu();var f={none:(!g)?true:false,transitions:(g&&c.settings.transitionsSupported)?true:false};if(f.transitions||f.none){if(f.none){c.disableTransitions()}if(f.transitions){c.enableTransitions(c.options.openDuration,c.options.openEasing)}var e=c.computePositionStyle(true);c.setPanelStyle(e);c.timeouts.afterOpen=setTimeout(function(){c.options.after();c.options.afterOpen();c.initiateContentClickListeners()},c.options.openDuration)}else{var d=c.getJSEasingFunction(c.options.openEasing);var h={};h[c.options.direction]=c.options.openPosition;a(c.panel).stop().animate(h,c.options.openDuration,d,function(){c.options.after();c.options.afterOpen();c.initiateContentClickListeners()})}},closeMenu:function(g){if(typeof(g)=="undefined"||g==null){g=c.options.animated}c.clearTimeouts();c.options.before();c.options.beforeClose();c.setMenuState(false);var f={none:(!g)?true:false,transitions:(g&&c.settings.transitionsSupported)?true:false};if(f.transitions||f.none){if(f.none){c.disableTransitions()}if(f.transitions){c.enableTransitions(c.options.closeDuration,c.options.closeEasing)}var e=c.computePositionStyle();c.setPanelStyle(e);c.timeouts.afterClose=setTimeout(function(){c.disableTransitions();c.hideMenu();c.options.after();c.options.afterClose();c.destroyContentClickListeners()},c.options.closeDuration)}else{var d=c.getJSEasingFunction(c.options.closeEasing);var h={};h[c.options.direction]=0+c.settings.positionUnits;a(c.panel).stop().animate(h,c.options.closeDuration,d,function(){c.hideMenu();c.options.after();c.options.afterClose();c.destroyContentClickListeners()})}},triggerMenu:function(d){if(c.menuIsOpen()){c.closeMenu(d)}else{c.openMenu(d)}},initiateClickListeners:function(){a(document).on("click touchend",c.options.trigger,function(d){c.triggerMenu(c.options.animated);d.preventDefault()})},destroyClickListeners:function(){a(document).off("click touchend",c.options.trigger,null)},initiateContentClickListeners:function(){if(!c.options.closeOnContentClick){return false}a(document).on("click touchend",c.panel,function(d){if(c.menuIsOpen()){c.closeMenu(c.options.animated)}d.preventDefault()})},destroyContentClickListeners:function(){if(!c.options.closeOnContentClick){return false}a(document).off("click touchend",c.panel,null)},initiateKeyboardListeners:function(){var d=["input","textarea","select"];a(document).on("keydown",function(i){var h=a(i.target),f=false;a.each(d,function(){if(h.is(this.toString())){f=true}});if(f){return true}for(mapping in c.options.keyboardShortcuts){if(i.which==c.options.keyboardShortcuts[mapping].code){var g=c.options.keyboardShortcuts[mapping];if(g.open&&g.close){c.triggerMenu(c.options.animated)}else{if((g.open&&!g.close)&&!c.menuIsOpen()){c.openMenu(c.options.animated)}else{if((!g.open&&g.close)&&c.menuIsOpen()){c.closeMenu(c.options.animated)}}}i.preventDefault()}}})},destroyKeyboardListeners:function(){a(document).off("keydown",null)},setupMarkup:function(){a("html").addClass("jPanelMenu");a(c.options.panel+" > *").not(c.menu+", "+c.options.excludedPanelContent).wrapAll('<div class="'+c.panel.replace(".","")+'"/>');var d=(c.options.clone)?a(c.options.menu).clone(c.options.keepEventHandlers):a(c.options.menu);d.attr("id",c.menu.replace("#","")).insertAfter(c.options.panel+" > "+c.panel)},resetMarkup:function(){a("html").removeClass("jPanelMenu");a(c.options.panel+" > "+c.panel+" > *").unwrap();a(c.menu).remove()},init:function(){c.options.beforeOn();c.setPositionUnits();c.setCSSPrefix();c.initiateClickListeners();if(Object.prototype.toString.call(c.options.keyboardShortcuts)==="[object Array]"){c.initiateKeyboardListeners()}c.setjPanelMenuStyles();c.setMenuState(false);c.setupMarkup();c.setPanelStyle({position:((c.options.animated&&c.settings.panelPosition==="static")?"relative":c.settings.panelPosition)});c.setMenuStyle({width:c.options.openPosition});c.closeMenu(false);c.options.afterOn()},destroy:function(){c.options.beforeOff();c.closeMenu();c.destroyClickListeners();if(Object.prototype.toString.call(c.options.keyboardShortcuts)==="[object Array]"){c.destroyKeyboardListeners()}c.resetMarkup();var d={};d[c.options.direction]="auto";c.options.afterOff()}};return{on:c.init,off:c.destroy,trigger:c.triggerMenu,open:c.openMenu,close:c.closeMenu,isOpen:c.menuIsOpen,menu:c.menu,getMenu:function(){return a(c.menu)},panel:c.panel,getPanel:function(){return a(c.panel)},setPosition:function(d){if(typeof(d)=="undefined"||d==null){d=c.options.openPosition}c.options.openPosition=d;c.setMenuStyle({width:c.options.openPosition})}}}})(jQuery);